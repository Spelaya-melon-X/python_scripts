import subprocess

# –ò–º—è –≤—ã—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
output_file = "31.mp4"

#  –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ (—Å–æ–≤–µ—Ç: –∑–∞–ø—É—Å—Ç–∏ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –æ—Ç–¥–µ–ª—å–Ω–æ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ):
# ffmpeg -f avfoundation -list_devices true -i ""
video_device_index = 0
audio_device_index = 1  # –µ—Å–ª–∏ –∑–≤—É–∫ –Ω–µ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è, –ø–æ–ø—Ä–æ–±—É–π 1 –∏–ª–∏ 2

cmd = [
    "ffmpeg",
    "-y",  # ‚ö° —Ä–∞–∑—Ä–µ—à–∏—Ç—å –ø–µ—Ä–µ–∑–∞–ø–∏—Å—å –≤—ã—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ –±–µ–∑ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
    "-f", "avfoundation",
    "-framerate", "30",
    "-pixel_format", "yuyv422",  # —Å—Ç–∞–±–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–ª—è macOS
    "-i", f"{video_device_index}:{audio_device_index}",  # –≤–∏–¥–µ–æ:–∞—É–¥–∏–æ
    "-c:v", "libx264",
    "-preset", "veryfast",
    "-c:a", "aac",
    "-b:a", "128k",  # –∫–∞—á–µ—Å—Ç–≤–æ –∑–≤—É–∫–∞
    "-r", "30",      # FPS
    "-t", "30",      # –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (—Å–µ–∫)
    output_file
]

print("üî¥ –ù–∞—á–∏–Ω–∞–µ—Ç—Å—è –∑–∞–ø–∏—Å—å –≤–∏–¥–µ–æ (30 —Å–µ–∫—É–Ω–¥)...")
print("üì∏ –£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞: –∫–∞–º–µ—Ä–∞ =", video_device_index, ", –º–∏–∫—Ä–æ—Ñ–æ–Ω =", audio_device_index)
print(f"üíæ –ó–∞–ø–∏—Å—å –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤ {output_file}")

subprocess.call(cmd)

print("‚úÖ –ó–∞–ø–∏—Å—å –≤–∏–¥–µ–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∞:", output_file)
